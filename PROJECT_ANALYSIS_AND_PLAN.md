# –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

**–î–∞—Ç–∞:** 11 –Ω–æ—è–±—Ä—è 2025  
**–ü—Ä–æ–µ–∫—Ç:** ClearMind App (EchoCare)  
**–ë–∞–∑–∞:** Supabase PostgreSQL

---

## üìã –ë–õ–û–ö 1: –ê–†–•–ò–¢–ï–ö–¢–£–†–ê - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–ë–î/ORM: Prisma –Ω–∞ Supabase Postgres**
   - ‚úÖ `prisma/schema.prisma` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `provider = "postgresql"`
   - ‚úÖ `DATABASE_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Supabase
   - ‚úÖ SQLite –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω –∏–∑ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

2. **NextAuth - JWT –±–µ–∑ —Ç–∞–±–ª–∏—Ü —Å–µ—Å—Å–∏–π**
   - ‚úÖ `src/lib/auth.ts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `strategy: "jwt"`
   - ‚úÖ –ù–µ—Ç —Ç–∞–±–ª–∏—Ü—ã Session –≤ Prisma schema
   - ‚úÖ Callbacks `jwt` –∏ `session` –ø—Ä–æ–∫–∏–¥—ã–≤–∞—é—Ç `id`, `email`, `role`

3. **TypeScript strict mode**
   - ‚úÖ `tsconfig.json` –∏–º–µ–µ—Ç `"strict": true`

4. **ESLint/Prettier**
   - ‚úÖ ESLint –Ω–∞—Å—Ç—Ä–æ–µ–Ω (flat-config —Å `typescript-eslint` –∏ `@next/eslint-plugin-next`)
   - ‚úÖ Prettier —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ devDependencies

5. **Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è**
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `src/lib/validations/auth.ts`
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `src/lib/auth.ts` –¥–ª—è credentials

6. **Middleware –∑–∞—â–∏—Ç–∞**
   - ‚úÖ `middleware.ts` –∑–∞—â–∏—â–∞–µ—Ç `/dashboard` –∏ `/admin`
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ ADMIN –¥–ª—è `/admin`

### ‚ùå –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:

1. **Supabase Storage**
   - ‚ùå –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Supabase Storage
   - ‚ùå –ù–µ—Ç bucket `journal-audio`
   - ‚ùå –ù–µ—Ç –ø–∞–∫–µ—Ç–∞ `@supabase/supabase-js` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API**
   - ‚ùå –ù–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö HTTP —Å—Ç–∞—Ç—É—Å–æ–≤ (400, 401, 403, 413, 415)
   - ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ MIME —Ç–∏–ø–æ–≤
   - ‚ùå –ù–µ—Ç –ª–∏–º–∏—Ç–æ–≤ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤

3. **RLS (Row Level Security)**
   - ‚ö†Ô∏è –ù–µ –≤–∫–ª—é—á–µ–Ω (—á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º - "–≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ –≤–∫–ª—é—á–∞–µ–º")

---

## üìã –ë–õ–û–ö 2: –°–ê–ú–û–ü–†–û–í–ï–†–ö–ê - –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —Ä–µ–ø–æ:

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:**
- ‚úÖ `app/api/auth/[...nextauth]/route.ts` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ `app/(auth)/register/page.tsx` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–Ω–æ –ø—É—Ç—å `/register`, –Ω–µ `/auth/register`)
- ‚úÖ `app/(auth)/login/page.tsx` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–Ω–æ –ø—É—Ç—å `/login`, –Ω–µ `/auth/login`)
- ‚úÖ `middleware.ts` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ `prisma/schema.prisma` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ `lib/prisma.ts` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ `lib/auth.ts` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–ü—Ä–æ–≤–µ—Ä–∫–∞ NextAuth:**
- ‚úÖ Credentials Provider –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ Callbacks `jwt` –∏ `session` –ø—Ä–æ–∫–∏–¥—ã–≤–∞—é—Ç `id`, `email`, `role`
- ‚úÖ JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ middleware:**
- ‚úÖ `/dashboard` –∑–∞—â–∏—â–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)
- ‚úÖ `/admin` –∑–∞—â–∏—â–µ–Ω (—Ç—Ä–µ–±—É–µ—Ç —Ä–æ–ª—å ADMIN)

**–ë–î —Å–≤—è–∑–Ω–æ—Å—Ç—å:**
- ‚úÖ `prisma validate` - —Å—Ö–µ–º–∞ –≤–∞–ª–∏–¥–Ω–∞
- ‚ö†Ô∏è `prisma migrate status` - –µ—Å—Ç—å –Ω–µ–ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è: `20251111232818_add_phone_field`
- ‚úÖ Datasource –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ PostgreSQL (Supabase)

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã:

1. **–ù–µ–ø—Ä–∏–º–µ–Ω–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è**
   - –ú–∏–≥—Ä–∞—Ü–∏—è `add_phone_field` –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
   - –ù—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `prisma migrate deploy` –Ω–∞ Railway

2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Supabase –∫–ª–∏–µ–Ω—Ç–∞**
   - –ù–µ—Ç –ø–∞–∫–µ—Ç–∞ `@supabase/supabase-js`
   - –ù–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Supabase –∫–ª–∏–µ–Ω—Ç–∞

---

## üìã –ë–õ–û–ö 3: –ü–†–û–§–ò–õ–¨ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø - –°—Ç–∞—Ç—É—Å

### ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:

1. **–ú–æ–¥–µ–ª–∏ Prisma:**
   - ‚ùå –ù–µ—Ç enum `Gender`
   - ‚ùå –ù–µ—Ç –º–æ–¥–µ–ª–∏ `Profile`

2. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
   - ‚ùå –ù–µ—Ç `GET /api/profile`
   - ‚ùå –ù–µ—Ç `PUT /api/profile`

3. **UI:**
   - ‚ùå –ù–µ—Ç —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞ `/dashboard`
   - ‚ùå –¢–µ–∫—É—â–∏–π `/dashboard` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ

---

## üìã –ë–õ–û–ö 4: –ñ–£–†–ù–ê–õ (–¢–ï–ö–°–¢ + –ê–£–î–ò–û) - –°—Ç–∞—Ç—É—Å

### ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:

1. **–ú–æ–¥–µ–ª–∏ Prisma:**
   - ‚ùå –ù–µ—Ç enum `JobStatus`
   - ‚ùå –ù–µ—Ç enum `EntryType`
   - ‚ùå –ù–µ—Ç –º–æ–¥–µ–ª–∏ `JournalEntry`
   - ‚ùå –ù–µ—Ç –º–æ–¥–µ–ª–∏ `AudioAsset`
   - ‚ùå –ù–µ—Ç –º–æ–¥–µ–ª–∏ `Job`

2. **Supabase Storage:**
   - ‚ùå –ù–µ—Ç bucket `journal-audio`
   - ‚ùå –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Storage API

3. **API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:**
   - ‚ùå –ù–µ—Ç `POST /api/journal/entries`
   - ‚ùå –ù–µ—Ç `GET /api/journal/entries`
   - ‚ùå –ù–µ—Ç `POST /api/journal/upload`

4. **UI:**
   - ‚ùå –ù–µ—Ç —Ñ–æ—Ä–º—ã —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
   - ‚ùå –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∑–∞–ø–∏—Å–∏ –∞—É–¥–∏–æ (MediaRecorder)
   - ‚ùå –ù–µ—Ç —Å–ø–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π

---

## üìã –ë–õ–û–ö 5: –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –ë–î –ù–ê SUPABASE

### ‚úÖ –£–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ `prisma/schema.prisma` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `provider = "postgresql"`
- ‚úÖ `DATABASE_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Supabase
- ‚ö†Ô∏è –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

---

## üéØ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô (TODO LIST)

### –§–ê–ó–ê 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ë–ª–æ–∫ 2)

#### 1.1 –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–µ–ø—Ä–∏–º–µ–Ω–µ–Ω–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é
- [ ] –í—ã–ø–æ–ª–Ω–∏—Ç—å `prisma migrate deploy` –Ω–∞ Railway (–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª–µ `phone` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—É `User`

#### 1.2 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase –∫–ª–∏–µ–Ω—Ç
- [ ] –î–æ–±–∞–≤–∏—Ç—å `@supabase/supabase-js` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –°–æ–∑–¥–∞—Ç—å `src/lib/supabase.ts` –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Service Role Key –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

#### 1.3 –°–æ–∑–¥–∞—Ç—å bucket –≤ Supabase Storage
- [ ] –°–æ–∑–¥–∞—Ç—å bucket `journal-audio` –≤ Supabase Dashboard
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å bucket –∫–∞–∫ private
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ Service Role

#### 1.4 –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ API
- [ ] –°–æ–∑–¥–∞—Ç—å `src/lib/api-errors.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫:
  - `400 Bad Request` - –¥–ª—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
  - `401 Unauthorized` - –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
  - `403 Forbidden` - –¥–ª—è –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
  - `413 Payload Too Large` - –¥–ª—è –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
  - `415 Unsupported Media Type` - –¥–ª—è –Ω–µ–≤–µ—Ä–Ω–æ–≥–æ MIME —Ç–∏–ø–∞
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ API —Ä–æ—É—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—à–∏–±–æ–∫

---

### –§–ê–ó–ê 2: –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ë–ª–æ–∫ 3)

#### 2.1 –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª–∏ Prisma
- [ ] –î–æ–±–∞–≤–∏—Ç—å enum `Gender` –≤ `prisma/schema.prisma`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å `Profile` —Å –ø–æ–ª—è–º–∏:
  - `id`, `userId` (unique), `fullName`, `birthDate`, `city`, `phone`, `locale`, `timezone`, `gender`, `createdAt`, `updatedAt`
- [ ] –î–æ–±–∞–≤–∏—Ç—å relation `Profile` ‚Üí `User` (1:1)
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: `pnpm prisma migrate dev --name add_profile`

#### 2.2 –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- [ ] –°–æ–∑–¥–∞—Ç—å `src/app/api/profile/route.ts`:
  - `GET /api/profile` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ–∑–¥–∞–µ—Ç –ø—É—Å—Ç–æ–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ)
  - `PUT /api/profile` - –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—è –ø—Ä–æ—Ñ–∏–ª—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å Zod —Å—Ö–µ–º—É –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ `src/lib/validations/profile.ts`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (—Ç–æ–ª—å–∫–æ owner –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å)

#### 2.3 –°–æ–∑–¥–∞—Ç—å UI –Ω–∞ /dashboard
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `src/app/dashboard/page.tsx`:
  - –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å —Å–µ—Ä–≤–µ—Ä-—Å–∞–π–¥ (SSR)
  - –ü–æ–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–æ—Ä–º—ã –ø—Ä–æ—Ñ–∏–ª—è:
  - –ü–æ–ª—è: `fullName`, `birthDate`, `city`, `phone`, `locale`, `timezone`, `gender`
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `react-hook-form` + `zod`
  - –ö–Ω–æ–ø–∫–∞ Save —Å toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º "Saved"
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

---

### –§–ê–ó–ê 3: –ñ—É—Ä–Ω–∞–ª - —Ç–µ–∫—Å—Ç + –∞—É–¥–∏–æ (–ë–ª–æ–∫ 4)

#### 3.1 –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª–∏ Prisma –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å enum `JobStatus` (PENDING, PROCESSING, DONE, FAILED)
- [ ] –î–æ–±–∞–≤–∏—Ç—å enum `EntryType` (TEXT, AUDIO)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å `JournalEntry`:
  - `id`, `userId`, `type`, `title`, `text`, `mood`, `energy`, `tags` (–º–∞—Å—Å–∏–≤), `audioId`, `createdAt`, `updatedAt`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å `AudioAsset`:
  - `id`, `userId`, `bucket`, `path`, `mime`, `size`, `duration`, `createdAt`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å `Job`:
  - `id`, `type`, `status`, `payload` (JSON), `entryId`, `createdAt`, `updatedAt`
- [ ] –î–æ–±–∞–≤–∏—Ç—å relations –º–µ–∂–¥—É –º–æ–¥–µ–ª—è–º–∏
- [ ] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: `pnpm prisma migrate dev --name add_journal_models`

#### 3.2 –°–æ–∑–¥–∞—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞
- [ ] –°–æ–∑–¥–∞—Ç—å `src/app/api/journal/entries/route.ts`:
  - `POST /api/journal/entries` - —Å–æ–∑–¥–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—É—é –∑–∞–ø–∏—Å—å (type=TEXT)
  - `GET /api/journal/entries?limit=20&cursor=...` - –ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–ø–∏—Å–∏
- [ ] –°–æ–∑–¥–∞—Ç—å `src/app/api/journal/upload/route.ts`:
  - `POST /api/journal/upload` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `multipart/form-data` —Å –ø–æ–ª–µ–º `file`
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Å—Å–∏—é, —Ä–∞–∑–º–µ—Ä ‚â§ MAX_AUDIO_MB, MIME ‚àà ALLOWED_AUDIO_MIME
  - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤ Supabase Storage —á–µ—Ä–µ–∑ Service Role
  - –°–æ–∑–¥–∞–µ—Ç `AudioAsset` –∏ `JournalEntry` (type=AUDIO, audioId=...)
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç entry
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã: `MAX_AUDIO_MB`, `ALLOWED_AUDIO_MIME`
- [ ] –î–æ–±–∞–≤–∏—Ç—å Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

#### 3.3 –°–æ–∑–¥–∞—Ç—å UI –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞ –Ω–∞ /dashboard
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ "–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å":
  - Textarea –¥–ª—è —Ç–µ–∫—Å—Ç–∞
  - –ö–Ω–æ–ø–∫–∞ "Save" ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ `POST /api/journal/entries`
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫ "–ó–∞–ø–∏—Å–∞—Ç—å –∞—É–¥–∏–æ":
  - –ö–Ω–æ–ø–∫–∞ "Record" / "Stop" (MediaRecorder API)
  - –û—Ç–ø—Ä–∞–≤–∫–∞ FormData –Ω–∞ `POST /api/journal/upload`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π:
  - –î–∞—Ç–∞, —Ç–∏–ø, –ø–µ—Ä–≤—ã–µ 120 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ "–ê—É–¥–∏–æ–∑–∞–º–µ—Ç–∫–∞ (N —Å–µ–∫)"
  - –ü–∞–≥–∏–Ω–∞—Ü–∏—è (cursor-based)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∑–∞–ø–∏—Å–∏
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –∏ –∑–∞–≥—Ä—É–∑–∫—É –∞—É–¥–∏–æ (5-10 —Å–µ–∫)

---

### –§–ê–ó–ê 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (–ë–ª–æ–∫ 7)

#### 4.1 –°–º–æ—É–∫-—Ç–µ—Å—Ç
- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ª–æ–≥–∏–Ω ‚Üí –¥–æ—Å—Ç—É–ø –∫ /dashboard
- [ ] –ó–∞–ø—Ä–µ—Ç /admin –¥–ª—è USER
- [ ] –î–æ—Å—Ç—É–ø /admin –¥–ª—è ADMIN (email –∏–∑ ADMIN_EMAILS)
- [ ] –ü—Ä–æ—Ñ–∏–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è
- [ ] –¢–µ–∫—Å—Ç–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ
- [ ] –ê—É–¥–∏–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –§–∞–π–ª—ã —Ä–µ–∞–ª—å–Ω–æ –ª–µ–∂–∞—Ç –≤ Supabase Storage
- [ ] –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –≤—ã–∑–æ–≤ API ‚Üí 401
- [ ] –ù–µ–≤–µ—Ä–Ω—ã–π MIME ‚Üí 415
- [ ] –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ ‚Üí 413

#### 4.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- [ ] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–µ–∫—Ä–µ—Ç–æ–≤
- [ ] Service Role Key –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –∫–ª–∏–µ–Ω—Ç—É
- [ ] –î–æ—Å—Ç—É–ø –∫ –∑–∞–ø–∏—Å—è–º —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞

---

## üìä –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –°–û–û–¢–í–ï–¢–°–¢–í–ò–Ø

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-----------|--------|-----------|
| –ë–î: Prisma + Supabase Postgres | ‚úÖ –ì–æ—Ç–æ–≤–æ | - |
| NextAuth JWT | ‚úÖ –ì–æ—Ç–æ–≤–æ | - |
| TypeScript strict | ‚úÖ –ì–æ—Ç–æ–≤–æ | - |
| ESLint/Prettier | ‚úÖ –ì–æ—Ç–æ–≤–æ | - |
| Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è | ‚úÖ –ì–æ—Ç–æ–≤–æ | - |
| Middleware –∑–∞—â–∏—Ç–∞ | ‚úÖ –ì–æ—Ç–æ–≤–æ | - |
| Supabase Storage | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üî¥ –í—ã—Å–æ–∫–∏–π |
| –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫ API | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üü° –°—Ä–µ–¥–Ω–∏–π |
| –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üî¥ –í—ã—Å–æ–∫–∏–π |
| –ñ—É—Ä–Ω–∞–ª (—Ç–µ–∫—Å—Ç + –∞—É–¥–∏–æ) | ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç | üî¥ –í—ã—Å–æ–∫–∏–π |
| –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |

---

## üîç –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò –ò –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### –ß—Ç–æ —Ö–æ—Ä–æ—à–æ:
1. ‚úÖ –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
2. ‚úÖ NextAuth –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å JWT
3. ‚úÖ –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. ‚úÖ TypeScript strict mode –≤–∫–ª—é—á–µ–Ω
5. ‚úÖ ESLint –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:
1. ‚ö†Ô∏è **–ú–∏–≥—Ä–∞—Ü–∏—è `add_phone_field` –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞** - –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
2. ‚ö†Ô∏è **–ù–µ—Ç Supabase Storage –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –∂—É—Ä–Ω–∞–ª–∞
3. ‚ö†Ô∏è **–ù–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –æ—à–∏–±–æ–∫ API** - –≤–∞–∂–Ω–æ –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
4. ‚ö†Ô∏è **–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –ø—Ä–æ—Ñ–∏–ª—è –∏ –∂—É—Ä–Ω–∞–ª–∞** - –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—ä–µ–º —Ä–∞–±–æ—Ç—ã

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
1. **–°–Ω–∞—á–∞–ª–∞:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase –∫–ª–∏–µ–Ω—Ç (–§–∞–∑–∞ 1.1-1.3)
2. **–ó–∞—Ç–µ–º:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–§–∞–∑–∞ 2) - –ø—Ä–æ—â–µ, –±—ã—Å—Ç—Ä–µ–µ
3. **–ü–æ—Ç–æ–º:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∂—É—Ä–Ω–∞–ª (–§–∞–∑–∞ 3) - —Å–ª–æ–∂–Ω–µ–µ, —Ç—Ä–µ–±—É–µ—Ç Storage
4. **–í –∫–æ–Ω—Ü–µ:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–§–∞–∑–∞ 1.4, –§–∞–∑–∞ 4)

### –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è:
1. –ö–∞–∫–æ–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∞—É–¥–∏–æ —Ñ–∞–π–ª–∞? (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ: 10-20 MB)
2. –ö–∞–∫–∏–µ MIME —Ç–∏–ø—ã —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –¥–ª—è –∞—É–¥–∏–æ? (–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ: `audio/webm`, `audio/mp3`, `audio/wav`)
3. –ù—É–∂–Ω–∞ –ª–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ —Å—Ä–∞–∑—É –∏–ª–∏ –º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å? (—Å–æ–≥–ª–∞—Å–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º - "–±–µ–∑ –ò–ò" –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ)

---

## üìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –ø–ª–∞–Ω–∞:
1. –ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1 (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
2. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –§–∞–∑—ã 2 –∏ 3
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–§–∞–∑–∞ 4)
4. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ì–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–æ–±—Ä–µ–Ω–∏—è!** üöÄ

